<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>IDEAL CORE | –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫–ª—é—á–∞–º–∏</title>
    <style>
        :root { --bg: #0f0f1a; --card: #1a1a2e; --text: #e0e0e0; --accent: #00d9ff; --danger: #ff4444; --success: #00ff88; }
        body { font-family: monospace; background: var(--bg); color: var(--text); margin: 0; padding: 20px; }
        .container { max-width: 800px; margin: 0 auto; }
        .warning { background: var(--danger); color: white; padding: 15px; border-radius: 8px; margin: 20px 0; }
        .key-card { background: var(--card); padding: 20px; border-radius: 8px; margin: 10px 0; border: 1px solid #333; }
        .key-value { font-family: monospace; background: #0f0f1a; padding: 10px; border-radius: 4px; word-break: break-all; }
        button { background: var(--accent); color: #000; border: none; padding: 10px 20px; border-radius: 4px; cursor: pointer; margin: 5px; }
        button.danger { background: var(--danger); color: white; }
        .hidden { display: none; }
    </style>
</head>
<body>
    <div class="container">
        <h1>üîê –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫—Ä–∏–ø—Ç–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∏–º–∏ –∫–ª—é—á–∞–º–∏</h1>
        
        <div class="warning">
            ‚ö†Ô∏è <strong>–ö–†–ò–¢–ò–ß–ï–°–ö–û–ï –ü–†–ï–î–£–ü–†–ï–ñ–î–ï–ù–ò–ï</strong><br>
            –í–∞—à –ø—Ä–∏–≤–∞—Ç–Ω—ã–π –∫–ª—é—á ‚Äî —ç—Ç–æ –≤–∞—à–∞ –ª–∏—á–Ω–æ—Å—Ç—å –≤ —Å–µ—Ç–∏.<br>
            ‚Ä¢ –ù–ò–ö–û–ì–î–ê –Ω–µ –ø–µ—Ä–µ–¥–∞–≤–∞–π—Ç–µ –µ–≥–æ —Ç—Ä–µ—Ç—å–∏–º –ª–∏—Ü–∞–º<br>
            ‚Ä¢ –ù–ò–ö–û–ì–î–ê –Ω–µ –∑–∞–≥—Ä—É–∂–∞–π—Ç–µ –≤ –æ–±–ª–∞–∫–æ –±–µ–∑ —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è<br>
            ‚Ä¢ –ù–ò–ö–û–ì–î–ê –Ω–µ —Ö—Ä–∞–Ω–∏—Ç–µ –≤ –æ—Ç–∫—Ä—ã—Ç–æ–º –≤–∏–¥–µ<br>
            –ü–æ—Ç–µ—Ä—è –∫–ª—é—á–∞ = –ø–æ—Ç–µ—Ä—è –¥–æ—Å—Ç—É–ø–∞. –ö–æ–º–ø—Ä–æ–º–µ—Ç–∞—Ü–∏—è = –ø–æ—Ç–µ—Ä—è –∫–æ–Ω—Ç—Ä–æ–ª—è.
        </div>

        <div class="key-card">
            <h3>üóùÔ∏è –ü—É–±–ª–∏—á–Ω—ã–π –∫–ª—é—á (ID –≤ —Å–µ—Ç–∏)</h3>
            <div class="key-value" id="publicKey">–ó–∞–≥—Ä—É–∑–∫–∞...</div>
            <button onclick="copyToClipboard('publicKey')">üìã –ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å</button>
            <button onclick="downloadKey('public')">üíæ –°–∫–∞—á–∞—Ç—å</button>
        </div>

        <div class="key-card">
            <h3>üîí –ü—Ä–∏–≤–∞—Ç–Ω—ã–π –∫–ª—é—á (–ù–ò–ö–û–ú–£ –ù–ï –ü–û–ö–ê–ó–´–í–ê–¢–¨)</h3>
            <button onclick="togglePrivate()">üëÅÔ∏è –ü–æ–∫–∞–∑–∞—Ç—å/–°–∫—Ä—ã—Ç—å</button>
            <button onclick="downloadKey('private')" class="danger">üíæ –°–∫–∞—á–∞—Ç—å (–∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω–æ)</button>
            <div class="key-value hidden" id="privateKey">‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢</div>
            <p><small>–î–ª—è —Å–∫–∞—á–∏–≤–∞–Ω–∏—è –ø–æ—Ç—Ä–µ–±—É–µ—Ç—Å—è –ø–∞—Ä–æ–ª—å. –•—Ä–∞–Ω–∏—Ç–µ –≤ –±–µ–∑–æ–ø–∞—Å–Ω–æ–º –º–µ—Å—Ç–µ.</small></p>
        </div>

        <div class="key-card">
            <h3>üåê Yggdrasil IPv6</h3>
            <div class="key-value" id="yggIP">–ó–∞–≥—Ä—É–∑–∫–∞...</div>
            <button onclick="copyToClipboard('yggIP')">üìã –ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å</button>
        </div>

        <div class="key-card">
            <h3>üíæ –†–µ–∑–µ—Ä–≤–Ω–∞—è –∫–æ–ø–∏—è</h3>
            <p>–°–æ–∑–¥–∞–π—Ç–µ –∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω–Ω—É—é —Ä–µ–∑–µ—Ä–≤–Ω—É—é –∫–æ–ø–∏—é –≤–∞—à–∏—Ö –∫–ª—é—á–µ–π.</p>
            <input type="password" id="backupPass" placeholder="–ü–∞—Ä–æ–ª—å –¥–ª—è —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è" style="width:100%;padding:10px;margin:5px 0;background:#0f0f1a;border:1px solid #333;color:var(--text);">
            <button onclick="createBackup()">üîê –°–æ–∑–¥–∞—Ç—å —Ä–µ–∑–µ—Ä–≤–Ω—É—é –∫–æ–ø–∏—é</button>
            <p><small>–†–µ–∑–µ—Ä–≤–Ω–∞—è –∫–æ–ø–∏—è –±—É–¥–µ—Ç –∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω–∞ —É–∫–∞–∑–∞–Ω–Ω—ã–º –ø–∞—Ä–æ–ª–µ–º.</small></p>
        </div>
    </div>

    <script>
        async function loadKeys() {
            try {
                const res = await fetch('/api/keys', {
                    headers: { 'Authorization': localStorage.getItem('ideal_token') }
                });
                const data = await res.json();
                document.getElementById('publicKey').textContent = data.public_key;
                document.getElementById('yggIP').textContent = data.yggdrasil_ip;
            } catch (e) {
                console.error('Failed to load keys:', e);
            }
        }

        function togglePrivate() {
            const el = document.getElementById('privateKey');
            el.classList.toggle('hidden');
            if (!el.classList.contains('hidden')) {
                el.textContent = '‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢ [–†–∞—Å—à–∏—Ñ—Ä–æ–≤–∫–∞ —Ç—Ä–µ–±—É–µ—Ç –ª–æ–∫–∞–ª—å–Ω–æ–≥–æ –¥–æ—Å—Ç—É–ø–∞]';
            }
        }

        function copyToClipboard(elementId) {
            const text = document.getElementById(elementId).textContent;
            navigator.clipboard.writeText(text).then(() => {
                alert('–°–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–æ –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞');
            });
        }

        function downloadKey(type) {
            if (type === 'private') {
                alert('‚ö†Ô∏è –ü—Ä–∏–≤–∞—Ç–Ω—ã–π –∫–ª—é—á –º–æ–∂–µ—Ç –±—ã—Ç—å —Å–∫–∞—á–∞–Ω —Ç–æ–ª—å–∫–æ –ª–æ–∫–∞–ª—å–Ω–æ —á–µ—Ä–µ–∑ CLI.\n\n–ö–æ–º–∞–Ω–¥–∞:\n  ideal-core backup --export-private --encrypt');
                return;
            }
            const key = document.getElementById('publicKey').textContent;
            const blob = new Blob([key], {type: 'text/plain'});
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = 'ideal-core-public.key';
            a.click();
        }

        function createBackup() {
            const pass = document.getElementById('backupPass').value;
            if (!pass) {
                alert('–í–≤–µ–¥–∏—Ç–µ –ø–∞—Ä–æ–ª—å –¥–ª—è —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è');
                return;
            }
            alert('üîê –†–µ–∑–µ—Ä–≤–Ω–∞—è –∫–æ–ø–∏—è —Å–æ–∑–¥–∞—ë—Ç—Å—è...\n\n–í –ø—Ä–æ–¥–∞–∫—à–µ–Ω–µ: –∫–ª—é—á–∏ —à–∏—Ñ—Ä—É—é—Ç—Å—è –ª–æ–∫–∞–ª—å–Ω–æ —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º –≤–∞—à–µ–≥–æ –ø–∞—Ä–æ–ª—è –∏ —Å–∫–∞—á–∏–≤–∞—é—Ç—Å—è –∫–∞–∫ —Ñ–∞–π–ª .backup.enc');
        }

        loadKeys();
    </script>
</body>
</html>
